define(["modules/jquery-mozu","hyprlive","shim!vendor/underscore>_","modules/api","modules/backbone-mozu","modules/models-product"],function(e,t,o,r,i,n){var s=require.mozuData("user"),a=i.MozuView.extend({templateName:"modules/product/product-instock-request",clearError:function(){this.setError("")},setError:function(e){this.$("[data-mz-validationmessage-for]").text(e)},widgetNotifyUserAction:function(){this.clearError();var e=s.isAnonymous?this.$('[data-mz-role="email"]').val():s.email;return e?(r.create("instockrequest",{email:e,customerId:s.accountId,productCode:this.model.get("productCode"),locationCode:this.model.get("inventoryInfo").onlineLocationCode}).then(function(){this.$('[data-mz-action="widgetNotifyUserAction"]').text(t.getLabel("subscribed")).prop("disabled",!0)}),void 0):(this.setError(t.getLabel("emailMissing")),!1)}});e(document).ready(function(){var t=n.Product.fromCurrent(),o=new a({model:n.Product.fromCurrent(),el:e(".mz-instock-request").parent()});t.attributes.inventoryInfo&&t.attributes.inventoryInfo.onlineStockAvailable<1?(o.render(),e(".mz-instock-request").css("display","inherit")):t.attributes.inventoryInfo?e(".mz-instock-request").parent().html(""):(o.render(),e(".mz-instock-request").css("display","inherit"))})});